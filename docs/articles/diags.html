<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stock Assessment Diagnostics with diags • diags</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Stock Assessment Diagnostics with diags">
<meta property="og:description" content="diags">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">diags</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="http://github.com/flr/FLCore">
    <span class="fa fa-github fa-lg"></span>
     
    Source
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://flr-project.org/">FLR</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stock Assessment Diagnostics with diags</h1>
                        <h4 class="author">Laurence Kell</h4>
            
            <h4 class="date">27 May, 2020</h4>
      
      
      <div class="hidden name"><code>diags.Rmd</code></div>

    </div>

    
    
<p><a href="#top"></a></p>
<p><a href="#Introduction">Introduction</a></p>
<p>Many stock assessment methods use linear regression e.g. for calibration when using CPUE as trends of relative abundance or as part of emprirical harvest control rules. Regression models, however, are vulnerable to abnormal points, which may cause bias, affect estimation accuracy and result in poor prediction skill. This is especially true when the number of observations are small as means there are fewer cases to counter them. Even if there are there many cases miscodes and excluding important explanatory variables can influence the regression model. It is important therefore to identify influential points and explore there impacts</p>
<p>In linear regression, abnormal points can be defined as when there is a large descrepency between the observed Y and predicted Y value given their X value (outlier) and when they have an unusual X-value (leverage). The influence of a point is a function of the discrepency and leverage, e.g.</p>
<pre><code>  Influence = Discrepency X Leverage</code></pre>
<p>Outliers can be identified using studentized residuals and quantile-comparison plots, leverage can be assessed by exploring the hat-values, and influence by calculating DFBeta or Cook???s Distance. While the bias in parameter estimates can be evaluated using simulation, e.g. the bootstrap or jackknife.</p>
<div id="outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#outliers" class="anchor"></a>Outliers</h2>
<p>In linear regression the standard deviations of residuals in a sample vary greatly from one data point to another even when if the errors all have the same standard deviation. It does not make sense therefore to compare residuals from different data points without first studentising, where a studentised residual is computed by dividing a residual by an estimate of its standard deviation.</p>
</div>
<div id="leverage" class="section level2">
<h2 class="hasAnchor">
<a href="#leverage" class="anchor"></a>Leverage</h2>
<p>The leverage of a point is related to how much the X value (i.e. the predictor variable) of an observation differs from the mean of that predictor variable. The greater the difference between the X value and the mean the more potential it has to be influential. For example, an observation with a X value equal to the mean has no influence on the slope of the regression line regardless of its Y value, only on the intercept. While a point with an extreme X value has the potential to affect the slope and the intercept.</p>
<p>To calculate the leverage first the predictor variable has to be standardised so that it has a mean of 0 and a standard deviation of 1. Then, the leverage (h) is computed by squaring the observation’s value on the standardised predictor variable, adding 1, and dividing by the number of observations.</p>
</div>
<div id="influence" class="section level2">
<h2 class="hasAnchor">
<a href="#influence" class="anchor"></a>Influence</h2>
<p>The influence of an observation’s is a function of the its leverage and the discrepency. An observation is influential if when omitted the predictions for the other observations differ, influence can be calculated by Cook’s D or the jackknife.</p>
<div id="cooks-d" class="section level3">
<h3 class="hasAnchor">
<a href="#cooks-d" class="anchor"></a>Cook’s D</h3>
<p>Cook’s D is a measure of the influence is proportional to the sum of the squared differences between predictions made with all observations in the analysis and predictions made leaving out the observation in question. If the predictions are the same regardless of whether the observation is included then it has no influence on the regression model. Alternatively if the predictions differ greatly when the observation is not included in the analysis, then the observation is influential.</p>
<p>A common rule of thumb is that an observation with a value of Cook’s D over 1.0 has too much influence. Although with all rules of thumb, it all depends.</p>
<p>An observation is influentila if when it is omitted the predictions for the other observations differ. ## Influence</p>
<p>An observation’s influence is a function of the leverage and the d Calculation of Cook’s D (Optional)</p>
<p>The first step in calculating the value of Cook’s D for an observation is to predict all the scores in the data once using a regression equation based on all the observations and once using all the observations except the observation in question. The second step is to compute the sum of the squared differences between these two sets of predictions. The final step is to divide this result by 2 times the MSE (see the section on partitioning the variance).</p>
<p>??? Influence Plots (or bubble plots) are useful because they display the studentized residuals, hat-values and Cook???s distances all on the same plot ??? Joint influence is best assessed using Added-Variable Plots (or partial-regression plots)</p>
</div>
</div>
<div id="bias" class="section level2">
<h2 class="hasAnchor">
<a href="#bias" class="anchor"></a>Bias</h2>
<p>Data sets with influential points can be linear or nonlinear. In this lesson, we went over an example in which an influential point increased the coefficient of determination. With respect to regression, outliers are influential only if they have a big effect on the regression equation. Sometimes, outliers do not have big effects. For example, when the data set is very large, a single outlier may not have a big effect on the regression equation.</p>
<p>A few questionable data points, i.e. outliers, can skew distributions, make significant results appear insignificant and have an large influence on results. Before identifying outliers it is necessary to characterise what are normal observations. This can be done by examining the overall shape of the data looking for important features and departures from assumptions then identifying any unusual observations that are far removed from the rest of the data. There are various graphical techniques for summarising data distributions, e.g. quantile-quantile, scatter and box plots. Throwing away inconvenient data when they do not support a hypothesis, however, is never a good idea and there is a simple procedure to identify small subsets of data that influence statistical measures. It is called the jackknife.</p>
<p>The jackknife is a resampling technique that is a special case of the bootstrap. It is a relatively simple and straightforward procedure, and has been widely adopted as an estimator of bias for any statistic and as a way to examine the stability of a variance estimate. The jackknife is therefore a useful tool in quality control by identifying outliers and bias in statistical estimates.</p>
<p>In these examples the jackknife procedure is used to identifying CPUE observations with large influence on assessment results.</p>
<p>The Jackknife can be used to illustrate uncertainty by removing one observations at a time sequentially for all observations. This allows the influence of individual points to be evaluated. For example if model estimates are driven by a single influential point results may be unstable.</p>
<p><a href="#Installation">Installation</a></p>
<p><a href="#QuickStart">Quick Start</a></p>
<p><a href="#Analysis">Analysis</a></p>
<p><a href="#More%20information">More information</a></p>
<p><a href="#References">References</a></p>
</div>
<div id="Introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#Introduction" class="anchor"></a>Introduction</h1>
<p><a href="#top">Back to Top</a></p>
</div>
<div id="Installation" class="section level1">
<h1 class="hasAnchor">
<a href="#Installation" class="anchor"></a>Installation</h1>
<p>The simplest way to obtain diags is to install it from CRAN by using the following command in the R console:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"diags"</span>, <span class="kw">repos</span> <span class="kw">=</span> <span class="st">"http://cloud.r-project.org/"</span>)</pre></body></html></div>
<p>The repos options can be changed depending on personal preferences and includes options such as choosing the directories in which to install the packages see help(install.packages) for more details.</p>
<p><a href="#top">Back to Top</a></p>
</div>
<div id="QuickStart" class="section level1">
<h1 class="hasAnchor">
<a href="#QuickStart" class="anchor"></a>Quick Start</h1>
<p>So that users may have a better idea of what methods are available, which to choose, and where to seek help this section provides a general overview of the package. It also provides some examples of usage, more details are given in later sections.</p>
<p>First, load the package:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">diags</span>)</pre></body></html></div>
<p>There is an example dataset for East Atlantic Bluefin, both for illustration and as a test dataset. Alternatively users can load their own data.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">dgs</span>)</pre></body></html></div>
<p>The dataset contains fits and residuals for the catch per unit effort (CPUE) used to calibarte a virtual population analysis.</p>
<p>As always when accessing a dataset it is a good thing to run a quick sanity check.</p>
<pre><code>[1] "data.frame" "list"       "oldClass"   "vector"    </code></pre>
<pre><code> [1] "name"        "year"        "x"           "y"           "yhat"       
 [6] "residual"    "sd"          "q"           "x2"          "y2"         
[11] "chi2"        "residualLag" "qqx"         "qqy"         "qqHat"      </code></pre>
<div id="plotting" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h3>
<p>Plotting is done using <code>ggplot2</code> which provides a powerful alternative paradigm for creating both simple and complex plots in R using the ideas the <em>Grammar of Graphics</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The idea of the grammar is to specify the individual building blocks of a plot and then to combine them to create the graphic desired<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<p>The <code>ggplot</code> functions expects a <code>data.frame</code> for its first argument, <code>data</code>; then a geometric object <code>geom</code> that specifies the actual marks put on to a plot and an aesthetic that is “something you can see” have to be provided. Examples of geometic Objects (geom) include points (geom_point, for scatter plots, dot plots, etc), lines (geom_line, for time series, trend lines, etc) and boxplot (geom_boxplot, for, well, boxplots!). Aesthetic mappings are set with the aes() function and, examples include, position (i.e., on the x and y axes), color (“outside” color), fill (“inside” color), shape (of points), linetype and size.</p>
<p>The CPUE series can be compared by plotting</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu">ggplot</span>(<span class="no">dgs</span>)+
  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="no">year</span>,<span class="no">y</span>,<span class="kw">group</span><span class="kw">=</span><span class="no">name</span>,<span class="kw">col</span><span class="kw">=</span><span class="no">name</span>))</pre></body></html></div>
<p><img src="tex/cpue-plot-1.png" width="768"></p>
<!--
### Box plots
Box plot construction   The box plot is a useful graphical display for describing the behavior of the data in the middle as well as at the ends of the distributions. The box plot uses the median and the lower and upper quartiles (defined as the 25th and 75th percentiles). If the lower quartile is Q1 and the upper quartile is Q3, then the difference (Q3 - Q1) is called the interquartile range or IQ.

Box plots with fences   A box plot is constructed by drawing a box between the upper and lower quartiles with a solid line drawn across the box to locate the median. The following quantities (called fences) are needed for identifying extreme values in the tails of the distribution:
lower inner fence: Q1 - 1.5*IQ
upper inner fence: Q3 + 1.5*IQ
lower outer fence: Q1 - 3*IQ
upper outer fence: Q3 + 3*IQ
Outlier detection criteria  A point beyond an inner fence on either side is considered a mild outlier. A point beyond an outer fence is considered an extreme outlier.
-->
</div>
<div id="split-apply-combine" class="section level3">
<h3 class="hasAnchor">
<a href="#split-apply-combine" class="anchor"></a>Split-apply-combine</h3>
<p><code>diags</code> contains a variety of functions to summarise assessment results. These are designed to be used with the <code>plyr</code> package to summarise and transform the data.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">plyr</span>)</pre></body></html></div>
<p><code>plyr</code> has methods for running split-apply-combine procedures, e.g. first splitting a dataset into subsets, then running a function on each subset and then recombining the results back into a single object.</p>
<p>An example of estimating the autocorrelation for a series</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>), <span class="kw">oma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>))

<span class="fu"><a href="https://rdrr.io/pkg/plyr/man/d_ply.html">d_ply</a></span>(<span class="no">dgs</span>, <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/quoted.html">.</a></span>(<span class="no">name</span>), <span class="no">with</span>, <span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span>(<span class="no">residual</span>,<span class="kw">lag.max</span><span class="kw">=</span><span class="fl">5</span>))</pre></body></html></div>
<p><img src="tex/plyr2-1.png" width="768"></p>
<p>plyr functions have a simple naming convention. The first two letters of the function tells the input and output data types, respectively. The one above takes a data.frame and returns nothing. The next example returns a data.frame</p>
<p>The first argument dgs is the input data frame , the next argument are the variables to subset by over which the statistics will be computed, and the third processes the data.frame by each subset. <code>with</code> creates an environment constructed from data in which to run <code>acf</code>.</p>
<p>Combining with ggplot2</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">qq</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ddply.html">ddply</a></span>(<span class="no">dgs</span>, <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/quoted.html">.</a></span>(<span class="no">name</span>), <span class="no">with</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span>(<span class="no">residual</span>,<span class="kw">plot</span><span class="kw">=</span><span class="fl">FALSE</span>)))

<span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="no">x</span>,<span class="no">y</span>),<span class="kw">data</span><span class="kw">=</span><span class="no">qq</span>)+
  <span class="fu">geom_point</span>()+
  <span class="fu">geom_smooth</span>(<span class="kw">method</span><span class="kw">=</span><span class="st">"lm"</span>)+
  <span class="fu">facet_wrap</span>(~<span class="no">name</span>)</pre></body></html></div>
<p><img src="tex/plyr3-1.png" width="768"></p>
<p><a href="#top">Back to Top</a></p>
</div>
</div>
<div id="Analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#Analysis" class="anchor"></a>Analysis</h1>
<p>The  package provides methods for plotting and summarising Catch per Unit Effort (CPUE) data used when fitting fish stock assessment methods. Programs for stock assessment are generally implemented as standalone executable programs with their own text files for input and output files.  provides a set of methods for reading these data and the results from fitting them nto R then using the % package for plotting.</p>
<div id="diags" class="section level2">
<h2 class="hasAnchor">
<a href="#diags" class="anchor"></a>diags</h2>
<p>The  method reads data from the various stock assessment files into a commom data frame.</p>
<p>The columns identify the observations ( and may include other covariates such as age, season, etc.), the original observations () and the fitted values and the residuals () if  has been used to read in the data, the residuals with a lag of 1 () and the quanitiles () assumming a normal distribution.</p>
<p>In some assessment packages the data are in a specific file in other cases the data are in a suite of files found in a dir. Therefore the  takes either a file or a dir as irs first arguemnt depending on the assessment method e.g. reading in from vpa2box and SS</p>
<p>For plotting and analysis the data may need to be transformed, e.g. observations scaled so that they can be compared, or pearson residuals computed. This can be done as required using  and , e.g. to standardise the residuals or scale them so that they lie between 0 and 1.</p>
<pre><code> [1]  1.201  0.736  0.355 -0.694 -0.429  1.695 -0.243 -1.639 -0.738 -0.244</code></pre>
<pre><code> [1] 0.420 0.321 0.207 1.000 0.000 0.595 0.783 0.408 0.615 0.982</code></pre>
<p>If you wish to scale the residuals within a series then the  can be used which implements the split-apply-combine strategy for  e.g.</p>
<p>One common definition, known as the Pearson residual, is as follows, however the definition depends on the law of large numbers, so it works less well where the number of points in each series is relatively small. Therefore in this anaysis we used the raw residuals, but the residuals could be transformed as required.</p>
<p>There may be other analyses that are useful to run on the raw data, e.g. running a GAM to calculate a common trend that the individual series can be compared to. I.e. to look for trends that may be different from the others. This can be done by fitting a smoother to year and a series effect, the latter scales the series so that they can be compared, e.g.</p>
<p><img src="tex/unnamed-chunk-4-1.png" width="768"></p>
<p><img src="tex/unnamed-chunk-5-1.png" width="768"></p>
<p>When producing a graphic you have to map data to the visual properties of geometric shapes (e.g. points, lines areas). This may require statistical transformations of the data, a coordinate system that postions the geometric objects on the page and facetting where mutiple plots can be generated. Each of these tasks are independent and the grammar breaks theses into four %components .</p>
<p>First we load up FLR and an example data set based on North Sea plaice. ggplot uses data in the form of a data.frame so we next have to convert the FLR object to a data.frame.</p>
<p>Facetting creates individual panels by the facetting variables, while themes allow you to prettify the plots.</p>
</div>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#exploratory-data-analysis" class="anchor"></a>Exploratory Data Analysis</h1>
<p>First the CPUE time series are plotted using  to plot the common trend as estimated by the GAM, then  fits a loess by series and then  is used to overlay the original observations.  then plots the series individually.  is a bespoke theme to change the look of the plot from the default.</p>

<p>The correlations between indices can be seen by plotting the indices against each other</p>
<img src="tex/unnamed-chunk-6-1.png" width="768"><p>The indices are then be grouped based on a cluster analysis</p>
<p><img src="tex/unnamed-chunk-7-1.png" width="768"></p>
<pre><code>NULL</code></pre>

<img src="tex/unnamed-chunk-8-1.png" width="768"><p>Next the fit to the indices is evaluated by plotting the residuals. The first plot is of the observed and the predicted values. Since <span class="math inline">\(U=qB\)</span>, i.e. the index is assumed to be proportional to stock size the points should fall either side of the <span class="math inline">\(y=x\)</span> line.</p>

Departures from the assumption that the index is proportional to the stock can also be seen by plotting the residuals by time. \begin{figure}\begin{center} <img src="tex/unnamed-chunk-9-1.png" width="768">

Autocorrelated residuals may mean that the estimated parameters are biased, autocorrelation can be checked by plotting the residuals against each other with a lag e.g. \begin{figure}\begin{center} <img src="tex/unnamed-chunk-10-1.png" width="768">

The error dostribution can be checked by plotting the observed and the predicted quantiles for a given distribution e.g. for the normal distributuion \begin{figure}\begin{center} <img src="tex/unnamed-chunk-11-1.png" width="768">

The variance \begin{figure}\begin{center} <img src="tex/unnamed-chunk-12-1.png" width="768"><p>Most CPUE series used in stock assessment have been standardised using a Generalised Linear Model (GLM). This requires choosing an appropriate error distribution, variance function andlink function .</p>
<p>The best way to check these assumptions are by plotting, best performed for a model that included all the main factors (i.e the most-complex model) since if the most complex model isnt a reasonable fit, then any simpler models that are selected will fit adequately because if they didn’t they wouldn’t be selected.</p>
<p>Going clockwise from the top left in figure~ the first panel is a q-q plot to check that the residuals follow a normal distribution, the standardised deviance residuals are then plotted against the fitted values to check for systematic departures from the assumptions underlying the error distribution, then thethe absolute values of the residuals against the fitted values as a check of the assumed variance function and finally the dependent variable against the linear predictor function as a check of the assumed link function .</p>
<p><a href="#top">Back to Top</a></p>
<p><a href="#More%20information">More information</a></p>
<ul>
<li>You can submit bug reports, questions or suggestions on <code>FLPKG</code> at the <code>FLPKG</code> issue page,<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> or on the <em>FLR</em> mailing list.</li>
<li>Or send a pull request to <a href="https://github.com/flr/FLPKG/" class="uri">https://github.com/flr/FLPKG/</a>
</li>
<li>For more information on the FLR Project for Quantitative Fisheries Science in R, visit the FLR webpage.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>
</li>
<li>The latest version of <code>FLPKG</code> can always be installed using the <code>devtools</code> package, by calling</li>
</ul>
<div class="sourceCode" id="cb14"><html><body><pre class="r">    <span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">'flr/FLPKG'</span>)</pre></body></html></div>
<div id="software-versions" class="section level2">
<h2 class="hasAnchor">
<a href="#software-versions" class="anchor"></a>Software Versions</h2>
<ul>
<li>R version 4.0.0 (2020-04-24)</li>
<li>FLCore: 2.6.15</li>
<li>FLPKG:</li>
<li>
<strong>Compiled</strong>: Wed May 27 09:01:41 2020</li>
<li>
<strong>Git Hash</strong>: 31a6634</li>
</ul>
</div>
<div id="author-information" class="section level2">
<h2 class="hasAnchor">
<a href="#author-information" class="anchor"></a>Author information</h2>
<p><strong>Laurence KELL</strong>. laurie.kell.es</p>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>This vignette and many of the methods documented in it were developed under the MyDas project funded by the Irish exchequer and EMFF 2014-2020. The overall aim of MyDas is to develop and test a range of assessment models and methods to establish Maximum Sustainable Yield (MSY) reference points (or proxy MSY reference points) across the spectrum of data-limited stocks.</p>
</div>
</div>
<div id="References" class="section level1">
<h1 class="hasAnchor">
<a href="#References" class="anchor"></a>References</h1>
<p><a href="#top">Back to Top</a></p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Wilkinson, L. 1999. <em>The Grammar of Graphics</em>, Springer. <a href="http://dx.doi.org/10.1007/978-3-642-21551-3_13">doi 10.1007/978-3-642-21551-3_13</a>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><a href="http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html" class="uri">http://tutorials.iq.harvard.edu/R/Rgraphics/Rgraphics.html</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><a href="https://github.com/flr/FLPKG/issues" class="uri">https://github.com/flr/FLPKG/issues</a><a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p><a href="http://flr-project.org" class="uri">http://flr-project.org</a><a href="#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Laurence T. Kell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
